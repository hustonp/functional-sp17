\documentclass[a4paper,10pt]{report}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage{fancyhdr}
\usepackage{enumitem}
\usepackage[top=1in,left=1in,right=1in]{geometry}
\usepackage{mathrsfs}
\usepackage{bm}

\usepackage{bbm}
\usepackage{tikz-cd}
\usepackage{stackengine}
\usepackage{Math_Symbols} 
\usepackage{ifpdf}
\ifpdf
%\usepackage[pdftex]{graphicx}
%\else
%\usepackage[dvips]{graphicx}
%\fi

\setenumerate{listparindent=\parindent,topsep=\parskip}
% \setlist[enumerate]{topsep=\parskip}
\setlist[enumerate,2]{label=(\arabic*)}
\setlist[enumerate,3]{label=(\alph*)}

% \newcommand{\set}[1]{{\{#1\}}}
\newcommand{\ggen}[1]{\langle#1\rangle}
\newcommand{\pn}[2]{||#1||_{#2}}
\newcommand{\bpn}[2]{\left|\left|#1\right|\right|_{#2}}
\newcommand{\norm}[1]{||#1||}
\newcommand{\bnorm}[1]{\left|\left|#1\right|\right|}
\DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}
\DeclarePairedDelimiter{\floor}{\lfloor}{\rfloor}
\DeclarePairedDelimiter{\set}{\{}{\}}
\DeclarePairedDelimiter{\abs}{|}{|}
\DeclarePairedDelimiter{\ket}{|}{\rangle}
\DeclarePairedDelimiter{\bra}{\langle}{|}

\newcommand{\ol}[1]{\overline{#1}}

\renewcommand{\mod}{\text{ mod }}

\renewcommand{\O}{\operatorname{O}} % Bound otherwise
\renewcommand{\o}{\operatorname{o}}
\newcommand{\T}{\text{yes}}
\newcommand{\F}{\text{no}}

\newcommand{\Z}{\mathbb{Z}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\textns}{\otimes}
\newcommand{\rar}[2][]{\overset{#2}{\underset{#1}{\longrightarrow}}}

\DeclareMathOperator{\img}{img}
\DeclareMathOperator{\fop}{int}
\DeclareMathOperator{\fcl}{cl}
% \DeclareMathOperator{\lg}{lg}
\DeclareMathOperator{\vspan}{span}
\DeclareMathOperator{\rng}{rng}
\DeclareMathOperator{\Rng}{Rng}
\DeclareMathOperator{\Cov}{Cov}
\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator{\Bernoulli}{Bernoulli}
\DeclareMathOperator{\Normal}{Normal}
\DeclareMathOperator{\Uniform}{Uniform}
\DeclareMathOperator{\Binom}{Binomial}
\DeclareMathOperator{\mgf}{mgf}
\DeclareMathOperator{\Supp}{Supp}

\newcommand{\cat}[1]{(\bm{#1})}

\providecommand{\Alpha}{A}

\newtheorem*{lemma*}{Lemma}

% Roman numerals
\makeatletter
\newcommand{\Romnum}[1]{\expandafter\@slowromancap\romannumeral #1@}
\makeatother
\newcommand{\factor}[1]{\text{\Romnum{#1}}}

\begin{document}
% \maketitle

\pagestyle{fancy}	
\fancyhf{} % Reset headers and footers
\lhead{Zachery Dell, Peter Huston, Samuel Mossing\\
Functional Analysis 2\\
\today}
\setlength{\headheight}{60pt}

\begin{center}
	\textbf{Homework 10}
\end{center}

\begin{enumerate}
		\setcounter{enumi}{99}
	\item
		\begin{enumerate}
			\item First, notice that the inclusion $\iota:N\to M$ is an isometry with respect to the trace-norm: If $a,b\in N$, then 
				\begin{align*}
					\ggen{a,b}_N &= \tr(b^*a)\\
					&= \tr(\iota(b)^*\iota(a))\\
					&= \ggen{a,b}_M
				\end{align*}
				Therefore, $\iota$ extends to an isometry $N\to L^2(M,\tr)$. Since $\iota$ is an isometry, $\iota$ extends continuously to the trace-norm closure of $N$, which is $L^2(N,\tr)$. Being an isometry, $\iota:L^2(N,\tr)\to L^2(M,\tr)$ must still be an inclusion. 
			\item Being an orthogonal projection, $e_N$ is norm-decreasing, and therefore continuous, with a continuous adjoint $e_N^*$. As for any projection onto a closed Hilbert subspace, we have $e_N^*=\iota$, and so $e_N^*e_N$ is the orthogonal projection onto $\iota(L^2(N,\tr))$, while $e_Ne_N^*=1_{L^2(N,\tr)}$. 

				Suppose $a,b\in N$, and let $\Omega_N$ be the image of $1_N$ in $L^2(N,\tr)$. Then we have 
				\begin{align*}
						JaJe_N^*b\Omega_N &= JaJb\Omega_N\\
						&= ba^*\Omega_N\\
						&= e_N^*ba^*\Omega_N\\
						&= e_N^*JaJb\Omega_N
				\end{align*}
				Since multiplication by a member of $n$ is continuous in one component (by Cauchy-Schwarz for the trace) and $e_N^*$ is norm-continuous, we can replace $b\Omega_N$ with any member of $L^2(N,\tr)$, so $e_N^*$ commutes with the right-action of $N$. 
				% The same holds for the right-action of members of $M$, and so by taking % unneeded!
				Taking 
				adjoints, $e_N$ also commutes with the right action: for $a\in N$, $\eta\in L^2(M,\tr)$, and $\xi\in L^2(N,\tr)$, 
				\begin{align*}
					\ggen{JaJe_N\eta,\xi} &= \ggen{\eta,e_N^*Ja^*J\xi}\\
					&= \ggen{\eta,Ja^*Je_N^*\xi}\\
					&= \ggen{e_NJaJ\eta,\xi}
				\end{align*}

				Clearly, the left action of a member of $M$ and the right action of a member of $N$ on $L^2(M,\tr)$ commute. Combining these three facts, for every $x\in M$, $e_Nxe_N^*$ commutes with the right action of $N$ on $L^2(N,\tr)$. By problem 91 part 8, we have $e_Nxe_N^*\in(JNJ)'=N$, where commutant is relative to $B(L^2(N,\tr))$. 
			\item Pick $x\in M$. 
				% Write $x^*=z+w$ where $z\in L^2(N,\tr)$ and $w\in L^2(N,\tr)^\perp\subseteq L^2(M,\tr)$. 
				% Then $e_Nx^*=e_Nz=z$. 
				Then, for any $y\in N$, we have 
				\begin{align*}
					\tr(E(x)y)_N &= \ggen{e_Nx^*e_N^*\Omega_N,y\Omega_N}_N\\
					&= \ggen{x^*e_N^*\Omega_N,e_N^*y\Omega_N}_M\\
					&= \ggen{x^*\Omega_M,y\Omega_M}_M\\
					&= \tr(xy)_M
				\end{align*}
				
				A Hilbert space is in weak duality with itself, so for any Hilbert space $H$, an element $\eta\in H$ is uniquely determined by a choice of $(\ggen{\eta,\xi})_{\xi\in H}$, provided such an $\eta$ exists. In particular, this holds for $\eta=E(x)$. 
		\end{enumerate}
	\item 
		\begin{enumerate}
			\item First, notice that $E$ preserves positivity: Suppose $x\in M$ is positive. Then for any $\eta\in L^2(N,\tr)$, we have 
				\[\ggen{E(x)\eta,\eta}=\ggen{xe_N^*\eta,e_N^*\eta}\ge0\]
				Expanding on the last argument, the sesquilinear form induced by $E(x)$ is a restriction of the sesquilinear form induced by $x$: for $\eta,\xi\in L^2(N,\tr)$, we have 
				\begin{align*}
					\ggen{E(x)\eta,\xi}_N &= \ggen{xe_N^*\eta,e_N^*\xi}_M\\
					&= \ggen{x\eta,\xi}_M\\
				\end{align*}
				Therefore, if $x_\lambda\nearrow x$, then $E(x_\lambda)$ is still an increasing sequence of positive operators bounded by $E(x)$, and $E(x_\lambda)\nearrow E(x)$ weakly, and hence $\sigma$-WOT. By definition, $E$ is normal. 
			\item By the previous remark about sesquilinear forms, $E(1_M)=1_N$. Let $y,z,w\in N$ and $x\in M$ be given; then by part (3) of 100, 
				\begin{align*}
					\tr((yE(x)z)w)_N &= \tr(E(x)zwy)_N\\
					&= \tr(xzwy)_M\\
					&= \tr(yxzw)_M\\
					&= \tr(E(yxz)w)_N
				\end{align*}
				and by uniqueness, $E(yxz)=\tr(yE(x)z)$. 
			\item This follows from the remark about sesquilinear forms. 
			\item Let a matrix $a=((a_{i,j})_{i=1}^n)_{j=1}^n\in M_n(M)$ be given. As an unjustified notation, let $E(a)=(E(a_{i,j})_{i=1}^n)_{j=1}^n$. Choose a vector $\eta=(\eta_k)_{k=1}^n$ in $L^2(N,\tr)^n$. Then we have 
				\begin{align*}
					\ggen{a\eta,\eta} &= \sum_{i=1}^n\sum_{j=1}^n\ggen{a_{i,j}\eta_j,\eta_i}\\
					&= \sum_{i=1}^n\sum_{j=1}^n\ggen{E(a_{i,j})\eta_j,\eta_i}\\
					&= \ggen{E(a)\eta,\eta}
				\end{align*}
				Therefore, if $a$ is positive, then $E(a)$ is also positive, as desired. 
			\item Let $x\in M$. Then for every $\eta\in L^2(N)$, we have 
				\begin{align*}
					\ggen{E(x)^*E(x)\eta,\eta}_N &= \ggen{E(x)\eta,E(x)\eta}_N\\
					&= \ggen{e_N^*e_N(xe_N^*\eta),xe_N^*\eta}\\
					\intertext{As explained in solving the previous problem, $e_N^*e_N$ is an orthogonal projection, so we have }
					\ggen{E(x)^*E(x)\eta,\eta}_N &\le \ggen{xe_N^*\eta,xe_N^*\eta}\\
					&= \ggen{E(x^*x)\eta,\eta}
				\end{align*}
				Since $\eta$ was chosen arbitrarily, $E(x)^*E(x)\le E(x^*x)$. 
			\item The key here is that the inclusion $N\subseteq M$ is unital. If $E(x^*x)=0$, then in particular $\ggen{E(x^*x)\Omega_N,\Omega_N}=\ggen{x^*x\Omega_M,\Omega_M}=\norm{x}^2=0$, so $x=0$. 
		\end{enumerate}
	\item
			Notation: Let $H$ be the Hilbert space such that $M\subset B(H)$ (since it $M$ is a von Neumann algebra).
		\begin{enumerate}
			\item Assume first that $(x_\lambda) \subset M$ is a bounded net with $x_\lambda \rightarrow x$ SOT.  Therefore, for all $\xi\in H$ we have $x_\lambda \xi \rightarrow x\xi$.  Also note that since $$\|(x_\lambda - x)^* (x_\lambda - x)\xi \| \leq \|(x_\lambda - x)^*\| \|(x_\lambda - x)\xi \|$$ with $x_\lambda - x$ uniformly bounded in operator norm, this implies that $(x_\lambda - x)^*(x_\lambda - x) \rightarrow 0$ SOT.  Therefore since $Tr$ is normal, this implies that $Tr((x_\lambda - x)^*(x_\lambda - x)) \rightarrow 0$.  This is exactly the inner product on $L^2(M)$ and so we have $$\|x_\lambda\Omega - x\Omega \|^2 =  \langle (x_\lambda - x)\Omega, (x_\lambda - x)\Omega \rangle = Tr((x_\lambda - x)^*(x_\lambda - x)) \rightarrow 0.$$ Thus we have shown that $x_\lambda \rightarrow x$ SOT in $M$ with $x_\lambda$ bounded implies that $\|x_\lambda\Omega - x\Omega \| \rightarrow 0$.
			\newline
			\newline \textbf{I believe the below argument is correct, but it is a little bit more precise than what I discussed with Peter.}  Conversely assume that $\|x_\lambda\Omega - x\Omega \|\rightarrow 0$ (with $x_\lambda$ still a bounded net in $M$), and thus $\|x_\lambda\Omega - x\Omega \|^2 \rightarrow 0$.  Therefore by definition we have $Tr((x_\lambda - x)^*(x_\lambda - x)) \rightarrow 0$ with $(x_\lambda - x)^*(x_\lambda - x) \geq 0$ for all $\lambda$.  Now note that since $x_\lambda$ is uniformly bounded we have that $(x_\lambda - x)^*(x_\lambda - x)$ is a bounded net of positive operators in $M$.  Now recall that the unit ball of $M$ is $\sigma$-WOT compact, and so we know that there exists a subnet of $(x_\lambda - x)^*(x_\lambda - x)$ which converges $\sigma$-WOT, say to $x$.  Since $Tr$ is normal and $Tr((x_\lambda - x)^*(x_\lambda - x)) \rightarrow 0$, this implies that $Tr(x) = 0$.  We know that $(x_\lambda - x)^*(x_\lambda - x)$ is a positive net (so every subnet is positive) and we know that weak limits of positive operators are positive (if $p_\lambda \rightarrow p$ all positive then $\langle p \xi,\xi \rangle = \lim_\lambda {\langle p_\lambda \xi, \xi \rangle} \geq 0$) and we know that on bounded sets the WOT and $\sigma$-WOT topologies agree.  This implies that $x\geq 0$ and thus since $x\geq 0$ and $Tr(x) = 0$ with $Tr$ faithful, we have shown that $x = 0$.  So we have shown that $(x_\lambda - x)^*(x_\lambda - x)$ is a bounded, positive net in $M$ which has a subnet converging $\sigma$-WOT to 0.  Moreover it is clear that 0 is the only limit point of the net $(x_\lambda - x)^*(x_\lambda - x)$ (if there is another limit point $y\neq 0$, it must also be positive and the limit of a subnet with $Tr(y) = 0$ and this contradicts faithfulness of $Tr$).  Therefore since $(x_\lambda - x)^*(x_\lambda - x)$ is a net in a $\sigma$-WOT compact set which has a unique limit point 0, this implies that $(x_\lambda - x)^*(x_\lambda - x) \rightarrow 0$ $\sigma$-WOT (if this convergence doesn't hold, then there is some $\sigma$-WOT open set $U$ containing 0 and some subnet which stays outside of $U$, and then since that subnet lives inside the complement of $U$ in the unit ball-another compact set- this subnet must have a nonzero limit point which gives us a contradiction).    Since this is a bounded net we have that $(x_\lambda - x)^*(x_\lambda - x) \rightarrow 0$ WOT.  Thus for all $\xi\in H$ we have $$\langle (x_\lambda - x)\xi, (x_\lambda - x)\xi \rangle = \langle (x_\lambda - x)^*(x_\lambda - x)\xi,\xi \rangle \rightarrow 0$$ and so $x_\lambda - x \rightarrow 0$ SOT.  Thus we have shown that $x_\lambda$ a bounded net in $M$ with $\|x_\lambda\Omega - x\Omega \|\rightarrow 0$ implies that $x_\lambda \rightarrow x$ SOT.
			\newline
			\newline Putting these together we have shown that for bounded nets $x_\lambda$ in $M$, $x_\lambda \rightarrow x$ SOT if and only if $\|x_\lambda \Omega - x\Omega\| \rightarrow 0$.
			\item Fix $x\in M$.  Fix $\epsilon > 0$.  By assumption we have $(\bigcup{M_n})'' = M$, and note that an increasing union of unital $*$-subalgebras is still a $*$-subalgebra.  Therefore by the von Neumann Bicommutant theorem we know that $(\bigcup{M_n})''$ is the SOT closure of $\bigcup{M_n}$.  Therefore $\bigcup{M_n}$ is a $*$-subalgebra which is SOT dense in $M$, a von Neumann algebra.  So by the Kaplansky density theorem there exists a bounded net $(x_\lambda)\subset \bigcup{M_n}$ such that $x_\lambda \rightarrow x$ SOT.  By part (1) this implies that $\|x_\lambda \Omega - x\Omega\| \rightarrow 0$, and so there exists some $\lambda$ such that $\|x_\lambda \Omega - x\Omega\| < \epsilon$.  We know that $x_\lambda \in M_n$ for some $n$, and so $x_\lambda \Omega \in L^2(M_n) \subset L^2(M)$ (using problems 100 and 101).  Also by problems 100 and 101 we know that $E_n(x)\Omega = e_n (x\Omega)$ where $e_n$ is the projection in $B(L^2(M))$ onto the closed subspace $L^2(M_n)\subset L^2(M)$.  Therefore by definition of projections we know that $$\|E_n(x)\Omega - x\Omega \| = \inf_{y\in L^2(M_n)}{\|y - x\Omega\|} \leq \|x_\lambda \Omega - x\Omega\| < \epsilon.$$ So we have that $\|E_n(x)\Omega - x\Omega \| < \epsilon$.  Observe that for all $m\geq n$, $E_m(x)\Omega = e_m(x\Omega)$ the projection onto the subspace $L^2(M_m)$ with $L^2(M_n)\subset L^2(M_m)\subset L^2(M)$.  So for all $m\geq n$ we have $e_m\geq e_n$ as projections and thus $\|E_m(x)\Omega - x\Omega \| \leq \|E_n(x)\Omega - x\Omega \|$ for all $m\geq n$.  Therefore we have shown that $\|E_m(x)\Omega - x\Omega \| < \epsilon$ for all $m\geq n$.  Since $\epsilon > 0$ is arbitrary we conclude that $\|E_n(x)\Omega - x\Omega\| \rightarrow 0$ as $n\rightarrow \infty$.
			\item By part (2) $\|E_n(x)\Omega - x\Omega\| \rightarrow 0$.  Also observe that $E_n(x)$ is a bounded sequence in $M$ (taking $H = B(L^2(M))$ here) \textbf{Is this actually true in general $H$? It is true if we take $M\subset B(L^2(M))$}.  Therefore by part (1) this implies that $E_n(x) \rightarrow x$ SOT as $n\rightarrow \infty$.
		\end{enumerate}
\end{enumerate}
\end{document}          
