\documentclass[a4paper,10pt]{report}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage{fancyhdr}
\usepackage{enumitem}
\usepackage[top=1in,left=1in,right=1in]{geometry}
\usepackage{mathrsfs}
\usepackage{bm}

\usepackage{bbm}
\usepackage{tikz-cd}
\usepackage{stackengine}
\usepackage{Math_Symbols} 
\usepackage{ifpdf}
\ifpdf
%\usepackage[pdftex]{graphicx}
%\else
%\usepackage[dvips]{graphicx}
%\fi

\setenumerate{listparindent=\parindent,topsep=\parskip}
% \setlist[enumerate]{topsep=\parskip}
\setlist[enumerate,2]{label=(\arabic*)}
\setlist[enumerate,3]{label=(\alph*)}

% \newcommand{\set}[1]{{\{#1\}}}
\newcommand{\ggen}[1]{\langle#1\rangle}
\newcommand{\pn}[2]{||#1||_{#2}}
\newcommand{\bpn}[2]{\left|\left|#1\right|\right|_{#2}}
\newcommand{\norm}[1]{||#1||}
\newcommand{\bnorm}[1]{\left|\left|#1\right|\right|}
\DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}
\DeclarePairedDelimiter{\floor}{\lfloor}{\rfloor}
\DeclarePairedDelimiter{\set}{\{}{\}}
\DeclarePairedDelimiter{\abs}{|}{|}
\DeclarePairedDelimiter{\ket}{|}{\rangle}
\DeclarePairedDelimiter{\bra}{\langle}{|}

\newcommand{\ol}[1]{\overline{#1}}

\newcommand{\eps}{\varepsilon}

\renewcommand{\mod}{\text{ mod }}

\renewcommand{\O}{\operatorname{O}} % Bound otherwise
\renewcommand{\o}{\operatorname{o}}
\newcommand{\T}{\text{yes}}
\newcommand{\F}{\text{no}}

\newcommand{\Z}{\mathbb{Z}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\tens}{\otimes}
\newcommand{\rar}[2][]{\overset{#2}{\underset{#1}{\longrightarrow}}}

\DeclareMathOperator{\img}{img}
\DeclareMathOperator{\fop}{int}
\DeclareMathOperator{\fcl}{cl}
% \DeclareMathOperator{\lg}{lg}
\DeclareMathOperator{\vspan}{span}
\DeclareMathOperator{\rng}{rng}
\DeclareMathOperator{\Rng}{Rng}
\DeclareMathOperator{\Cov}{Cov}
\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator{\Bernoulli}{Bernoulli}
\DeclareMathOperator{\Normal}{Normal}
\DeclareMathOperator{\Uniform}{Uniform}
\DeclareMathOperator{\Binom}{Binomial}
\DeclareMathOperator{\mgf}{mgf}
\DeclareMathOperator{\Supp}{Supp}

\newcommand{\cat}[1]{(\bm{#1})}

\providecommand{\Alpha}{A}

\newtheorem*{lemma*}{Lemma}

% Roman numerals
\makeatletter
\newcommand{\Romnum}[1]{\expandafter\@slowromancap\romannumeral #1@}
\makeatother
\newcommand{\factor}[1]{\text{\Romnum{#1}}}

\begin{document}
% \maketitle

\pagestyle{fancy}	
\fancyhf{} % Reset headers and footers
\lhead{Ethan Ackelsberg, Zachery Dell, Peter Huston\\
Functional Analysis 2\\
\today}
\setlength{\headheight}{60pt}

\begin{center}
	\textbf{Homework 13}
\end{center}
\begin{enumerate}
		\setcounter{enumi}{108}
	\item \textit{Beware: we could not make sense of the suggested part (1). We prove something which may or may not be the intended part (1), but which will enable a proof of (3), which seems to be the point of the exercise.}\\
		Given $\Phi:A\to M_n(\C)$, define $\psi:M_n(A)\to\C$ by $\psi(B)=n^{1/2}\sum_{i=1}^n\sum_{j=1}^n\Phi(B_{ij})_{ij}$. 
		\begin{enumerate}
			\item Suppose that $\Phi$ is completely positive. This means that if $B\in M_n(A)$ is positive, then the matrix $\Phi(B)$ with $\Phi(B)_{(i,k),(j,\ell)}=\Phi(B_{ij})_{k\ell}$ is also positive. Let $\delta\in(\C^n)^2$ be the vector with $\delta_{i,j}=1$ if $i=j$ and $0$ otherwise. Then $\psi(B)=n^{1/2}\ggen{\delta|\Phi(B)\delta}$ is positive.

				On the other hand, suppose that $\psi$ is positive. 
				% If $\Phi(1_A)=0$, then $\varphi(1_A)=0$, and since $\varphi$ is positive, $\varphi=0$. % Maybe we don't need this if we aren't asking for $\Phi$ unital?
				Stinespring's theorem says that completely positive maps from a unital {\csa} are precisely conjugations of *-homomorphisms by a morphism of Hilbert spaces. Therefore, we attempt to find such a decomposition for $\Phi$. 
				% Stinespring: $\Phi$ is unital iff the morphism of Hilbert spaces is an isometry. But maybe we can avoid running in this case. 
				As usual, the GNS construction gives a Hilbert space $H=L^2(M_n(A),\psi)$ with a representation $\pi_\psi:M_n(A)\to B(H^n)$ with cyclic vector $\Omega_\psi$ and inner product $\ggen{B\Omega_\psi|C\Omega_\psi}=\psi(B^*C)$. 
				% Since properties of positivity and complete positivty are preserved by multiplication by positive scalars, we may as well normalize $\Phi$ so that $\Omega_\varphi$ is also a unit vector. % This is not true when $\varphi(1_A)=0$, in which case we only have a trivial representation. In which case the proof is very strange. 
				Fix $n\in\N$. Let $(e_i)_{i=1}^n$ be the standard basis for $\C^n$, i.e $e_1=(1,0,0,\ldots, 0)$, $e_2=(0,1,0,\ldots 0)$, etc. Let $((E_{ij})_{i=1}^n)_{j=1}^n$ be the system of matrix units for $M_n(\C)$ such that $E_{ij}[i,j]=1$ all other entries of $E_{ij}$ are $0$.
				(It is possible that an arbitrary choice of basis and system of matrix units would suffice, but the definition of $\varphi$ seems basis dependent, making such a generalization tedious at best. In our defense, this seems true of $\varphi$ as well.)
				Let $\iota:M_n(\C)\to M_n(A)$ be induced by the structural morphism $\C\to A$. For brevity, we identify each $M$ with $\iota(M)$. Finally, let $h:A\to M_n(A)$ be the map so that for every $a\in A$ and $(i,j)$, we have $h(a)_{ij}=n^{-1/2}a$. Notice that $h$ is a non-unital (unless $n=1$) $*$-homomorphism. Since $\Phi$ might be non-unital as it is, this need not be too disturbing. 
				
				Define $V:\C^n\to H^n$ by $Ve_i=\pi_\psi(E_{i1})\vec{\Omega}_\psi$. Set $\Lambda:M_n(A)\to M_n(\C)$ by $\Lambda(B)=V^*\pi_\psi(B)V$. As we know well, $\Lambda$ must be completely positive. It can happen that $V$ is not an isometry, and indeed, this must happen if ever $\psi$ is not unital. 
				(It seems that this is unavoidable even by a better attack to the problem, because no matter what we do, we may simply have $\Phi=0$, or more generally, $\img(\Phi)$ may not have full rank.) 
				We claim that $\Phi=\Lambda\circ h$, making $\Phi$ the composition of completely positive maps, and hence completely positive. Observe: if $a\in A$, 
				\begin{align*}
					\Lambda(h(a))_{ij} &= \ggen{e_j|\Lambda(h(a))e_i}\\
					&= \ggen{e_j|V^*\pi_\psi(h(a))Ve_i}_{\C^n}\\
					&= \ggen{\Omega_\psi|\pi_\psi(E_{1j}h(a)E_{i1})\Omega_\psi}_{H^n}\\
					&= n^{1/2}\sum_{k,\ell}\Phi((E_{1j}h(a)E_{i1})[k,\ell])_{k,\ell}\\
					&= n^{1/2}\Phi(h(a)_{ij})_{ij}\\
					&= n^{1/2}n^{-1/2}\Phi(a)_{ij}\\
					&= \Phi(a)_{ij}
				\end{align*}
				as desired. 
			\item 
			\item By part (1), from $\Phi$, we obtain some positive linear functional $\psi:M_n(S)\to\C$. Using Hahn-Banach, we extend to $M_n(A)$. Applying the construction of part (1), we get $\Lambda:M_n(A)\to M_n(\C)$ completely positive. Define $\widetilde{\Phi}=\Lambda\circ h$. As we saw in part (1), we will have $\Lambda\circ h|_S=\Phi$, so $\widetilde{\Phi}|_A=\Phi$. Since $1_A\in S$, if $\Phi$ is unital, so is $\widetilde{\Phi}$. 
		\end{enumerate}
	\item	Suppose $\Gamma$ is a countable discrete group,
		and suppose $\varphi : L\Gamma \to L\Gamma$ is a normal completely positive map.
		Prove that $f : \Gamma \to \C$ given by $f(g) := \tr_{L\Gamma}(\varphi(\lambda_g)\lambda_g^*)$
		is a positive definite function.
		\begin{proof}
			Let $n \in \N$ and $g_1, \dots, g_n \in \Gamma$.
			Let $A \in M_n(\C)$ be the matrix with entries $a_{ij} = f(g_i^{-1}g_j)$.
			We want to show $A \ge 0$.
			Note that since $\tr$ is tracial, we can rewrite the entries as follows:
			\begin{align*}
				a_{ij} & = \tr_{L\Gamma}(\varphi(\lambda_{g_i^{-1}g_j})\lambda_{g_i^{-1}g_j}^*) \\
				 & = \tr_{L\Gamma}(\varphi(\lambda_{g_i}^* \lambda_{g_j})
				 \lambda_{g_j}^*\lambda_{g_i}) \\
				 & = \tr_{L\Gamma}(\lambda_{g_i}\varphi(\lambda_{g_i}^* \lambda_{g_j})
				 \lambda_{g_j}^*). \\
			\intertext{Let $x \in \C^n$. Then}
				\ggen{Ax, x} & = \sum_{i,j=1}^n{\ol{x}_i a_{ij} x_j} \\
				 & = \sum_{i,j=1}^n{\ol{x}_i \tr_{L\Gamma}(\lambda_{g_i}
				 \varphi(\lambda_{g_i}^* \lambda_{g_j})\lambda_{g_j}^*) x_j} \\
				 & = \tr_{L\Gamma}\left( \sum_{i,j=1}^n{\ol{x}_i \lambda_{g_i}
				 \varphi(\lambda_{g_i}^* \lambda_{g_j})\lambda_{g_j}^* x_j} \right) \\
				 & = \tr_{L\Gamma}\left( \sum_{i,j=1}^n{
				 \left( \ol{x}_i x_j \right)
				\left( \lambda_{g_i} \lambda_{g_j}^* \right)
				\varphi(\lambda_{g_i}^* \lambda_{g_j})} \right)
			\end{align*}
			
			Now, we explain why the tensor product of positive matrices valued in a von Neumann algebra is positive. Let $M\subseteq B(H)$ be a von Neumann algebra. We have already established an inclusion $M_n(B(H))\to B(H^n)$, such that if $A,B\in M_n(B(H))$, then the Kronecker tensor product of matrices $A\tens B$ defines the same operator as the operator tensor product $A\tens B$. The operator tensor product is $(A\tens I)(I\tens B)$, so it suffices to prove that the product of two commuting positive elements of a von Neumann algebra is positive. I assume we learned this last semester, so I looked up some of the details on Stack Exchange and in Analysis Now. 
		
		Let $A,B\in M$ be commuting positive operators. The product of commuting normal elements is normal, so it suffices to show that $\spec(AB)\subseteq\mathbb{R}$. We claim that $\Spec(AB)\subseteq\Spec(A)\Spec(B)$. If we let $N=\set{A,B}''$, then $N$ is a commuting von Neumann algebra, so by taking the Gelfand transform, $\Spec_N(B)\subseteq\Spec_N(A)\Spec_N(B)$. Now $\Spec_M\subseteq\Spec_N$, since $M\supseteq N$. However, $\Spec_N(A)=\Spec_M(A)$, because if $A-\lambda I$ is invertible in $A$, then by the continuous functional calculus, the inverse commutes with $A$ and $B$, and is therefore in $N$; similarly for $B$. Therefore, $\Spec_M(AB)\subseteq\Spec_N(AB)\subseteq\Spec_M(A)\Spec_M(B)\subseteq\mathbb{R}$. 
		\end{proof}
	% \item
	% 	\begin{enumerate}
	% 		\item 
	% 		\item 
	% 	\end{enumerate}
		\setcounter{enumi}{111}
	\item	Suppose that $\Gamma$ is a countable discrete group such that every cocycle is inner.
		Suppose $(H, \pi)$ is a unitary representation and $(\xi_n) \subseteq H$
		is a sequence of unit vectors such that $\|\pi_g\xi_n - \xi_n\| \to 0$ as $n \to \infty$
		for all $g \in \Gamma$.
		Follow the steps below to find a nonzero $\Gamma$-invariant vector in $H$.
		\begin{enumerate}
			\item Enumerate $\Gamma = \{g_1, g_2, \dots\}$.
				Explain why you can pass to a subsequence of $(\xi_n)$ to assume that
				for all $n \in \N$, $\|\pi_{g_i}\xi_n - \xi_n\| < 4^{-n}$ for all $1 \le i \le n$.
				\begin{proof}
					Since $\|\pi_{g_1}\xi_n - \xi_n\| \to 0$ as $n \to \infty$, we may
					choose $n_1 \in \N$ so that $\|\pi_{g_1}\xi_{n_1} - \xi_{n_1}\| < \frac{1}{4}$.
					
					Suppose we have $n_1 < n_2 < \dots < n_k$ so that
					$\|\pi_{g_i}\xi_{n_k} - \xi_{n_k}\| < 4^{-k}$ for all $1 \le i \le k$.
					For each $1 \le i \le k + 1$, choose $N_i \in \N$ so that
					$\|\pi_{g_i}\xi_n - \xi_n\| < 4^{-(k+1)}$ for all $n \ge N_i$.
					Set $n_{k+1} := \max\{N_1, \dots, N_{k+1}, n_k + 1\}$.
					Then $n_{k+1} > n_k$ and $n_{k+1} \ge N_i$ for each $1 \le i \le k+1$, so
					$\|\pi_{g_i}\xi_{n_{k+1}} - \xi_{n_{k+1}}\| < 4^{-(k+1)}$ for all $1 \le i \le k+1$.
					
					Replacing $(\xi_n)_{n \in \N}$ with $(\xi_{n_k})_{k \in \N}$
					gives a sequence of unit vectors with the desired property.
				\end{proof}
			\item For $n \in \N$, consider the inner cocycles $\beta_n(g) := \xi_n - \pi_g\xi_n$.
				Let $(K, \sigma) = \bigoplus_{n \in \N}{(H, \pi)}$.
				Define $\beta : \Gamma \to K$ by $\beta(g)_n = 2^n \beta_n(g)$.
				Prove that $\beta(g) \in H$ is well-defined for every $g \in \Gamma$.
				Then show $\beta$ is a cocycle for $(H, \pi)$.
				\begin{proof}
					Let $g \in \Gamma$.
					To show that $\beta(g)$ is well-defined, it suffices to show
					$\left( \|\beta(g)_n\| \right)_{n \in \N} \in \ell^2\N$.
					Suppose $N \in \N$ such that $g = g_N$ is the enumeration from (1).
					Then
					\begin{align*}
						\sum_{n \in \N}{\|\beta(g)_n\|^2} & = \sum_{n \in \N}{\|2^n \beta_n(g)\|^2} \\
						 & = \sum_{n \in \N}{4^n \|\pi_{g_N} \xi_n - \xi_n\|^2} \\
						 & \le \sum_{n=1}^{N-1}{4^n \|\pi_{g_N} \xi_n - \xi_n\|^2} 
						 + \sum_{n=N}^{\infty}{4^n (4^{-n})^2} \\
						 & = \sum_{n=1}^{N-1}{4^n \|\pi_{g_N} \xi_n - \xi_n\|^2}
						 + \frac{4^{-(N-1)}}{3} \\
						 & < \infty.
					\end{align*}
					
					Now we must check that $\beta$ is a cocycle.
					Let $g, h \in \Gamma$.
					Since $\beta_n$ is a cocycle for each $n \in \N$, we have
					\begin{align*}
						\beta(gh) & = \left( 2^n \beta_n(gh) \right)_{n \in \N} \\
						 & = \left( 2^n (\beta_n(g) + \pi_g\beta_n(h)) \right)_{n \in \N} \\
						 & = \left( 2^n \beta_n(g) \right)_{n \in \N}
						 + \left( \pi_g 2^n \beta_n(h) \right)_{n \in \N} \\
						 & = \left( 2^n \beta_n(g) \right)_{n \in \N}
						 + \sigma_g \left( 2^n \beta_n(h) \right)_{n \in \N} \\
						 & = \beta(g) + \sigma_g \beta(h).
					\end{align*}
					That is, $\beta$ is a cocycle.
				\end{proof}
			\item Deduce $\beta$ is inner and bounded.
				Thus there exists a $\kappa \in K \setminus \{0\}$
				such that $\beta(g) = \kappa - \sigma_g \kappa$ for all $g \in \Gamma$.
				\begin{proof}
					This follows immediately from the assumption that every cocycle is inner.
				\end{proof}
			\item Prove that $\|\beta_n(g)\| \to 0$ uniformly for $g \in \Gamma$.
				That is, show for all $\eps > 0$, there is an $N \in \N$ such that
				$n > N$ implies $\|\beta_n(g)\| < \eps$ for all $g \in \Gamma$.
				\begin{proof}
					Let $\eps > 0$.
					Choose $N \in \N$ with $N > 1 + \log_2{\frac{\|\kappa\|}{\eps}}$.
					Then for $n > N$ and $g \in \Gamma$, we have
					\begin{align*}
						\|\beta_n(g)\|_H & = 2^{-n}\|\kappa_n - \pi_g\kappa_n\|_H \\
						 & \le 2^{-(n-1)} \|\kappa_n\|_H \\
						 & \le 2^{-(N-1)} \|\kappa\|_K \\
						 & < \eps.
					\end{align*}
				\end{proof}
			\item Fix $N \in \N$ such that $\|\beta_N(g)\| = \|\xi_N - \pi_g\xi_N\| < 1$
				for all $g \in \Gamma$.
				Show that there is a $\xi_0 \in H \setminus \{0\}$
				such that $\pi_g\xi_0 = \xi_0$ for all $g \in \Gamma$.
				\begin{proof}
					Let $B := \{\pi_g\xi_N : g \in \Gamma\}$.
					Since $\pi$ is a unitary representation, $B \subseteq H_1$ is bounded.
					Let $f : H \to B$ be given by $f(\eta) := \sup_{\xi \in B}{\|\eta - \xi\|}$.
					Observe that $f$ is $\pi$-invariant:
					\begin{align*}
						f(\pi_g\eta) & = \sup_{\xi \in B}{\|\pi_g\eta - \xi\|} \\
						 & = \sup_{h \in \Gamma}{\|\pi_g\eta - \pi_h \xi_N\|} \\
						 & = \sup_{h \in \Gamma}{\|\eta - \pi_{g^{-1}h} \xi_N\|} \\
						 & = \sup_{k \in \Gamma}{\|\eta - \pi_k \xi_N\|} \\
						 & = \sup_{\xi \in B}{\|\eta - \xi\|} \\
						 & = f(\eta).
					\end{align*}
					
					Now by problem 106, $f$ achieves its minimum at a unique point $\xi_0 \in H$.
					Since $f(\pi_g\xi_0) = f(\xi_0)$ for all $g \in \Gamma$,
					uniqueness implies that $\xi_0$ is a $\Gamma$-invariant vector.
					
					Finally, $f(\xi_N) = \sup_{g \in \Gamma}{\|\beta_N(g)\|} \le 1 = f(0)$,
					and $\xi_N \ne 0$, so the unique point $\xi_0$ at which $f$ achieves its minimum
					must be a nonzero vector.
				\end{proof}
		\end{enumerate}
\end{enumerate}

\end{document}          
